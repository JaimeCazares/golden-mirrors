<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Registro de Partidos</title>

  <!-- CSS -->
  <link rel="stylesheet" href="style.css?v=1.0.0">
  <link rel="stylesheet" href="kg/kg.css?v=1.0.0">
  <link rel="stylesheet" href="deuda/deuda.css?v=1.0.0">
</head>

<body>

<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>

  <!-- ===== MODULOS DINAMICOS ===== -->
  <div id="kg-wrapper"></div>
  <div id="deuda-wrapper"></div>

  <!-- ===== CARGA KG ===== -->
 <script>
fetch('kg/kg.html', { cache: 'no-store' })
  .then(res => res.text())
  .then(html => {
    document.getElementById('kg-wrapper').innerHTML = html;
    const script = document.createElement('script');
    script.src = 'kg/kg.js?v=' + Date.now();
    script.onload = () => initKg(); // ğŸ”¥ CLAVE
    document.body.appendChild(script);
  });
</script>



  <!-- ===== CARGA DEUDA ===== -->
  <script>
fetch('deuda/deuda.html', { cache: 'no-store' })
  .then(res => res.text())
  .then(html => {
    document.getElementById('deuda-wrapper').innerHTML = html;
    const script = document.createElement('script');
    script.src = 'deuda/deuda.js?v=' + Date.now();
    script.onload = () => initDeuda(); // ğŸ”¥ CLAVE
    document.body.appendChild(script);
  });
</script>



<h1>ğŸ“Š Registro de Partidos</h1>
<button id="abrirModalBtn">â• Nuevo registro</button>
<button id="abrirHistorialBtn">ğŸ“œ Historial</button>

<div id="ligaFiltros" style="margin-top:10px;">
  <button class="filtro-btn" data-liga="Champions League">ğŸ† Champions League</button>
  <button class="filtro-btn" data-liga="Premier League">ğŸ´ Premier League</button>
  <button class="filtro-btn" data-liga="La Liga">ğŸ‡ªğŸ‡¸ La Liga</button>
  <button class="filtro-btn" data-liga="todas">ğŸŒ Ver todas</button>
</div>

<div id="partidosContainer"></div>

<!-- ===== MODAL ===== -->
<div class="modal" id="modal">
  <div class="modal-content">
    <span class="close" id="cerrarModalBtn">&times;</span>
    <h2 id="modalTitle">Nuevo Registro</h2>

    <div class="info-general">
      <input type="text" id="partido" placeholder="Introduce el nombre del partido" />
    </div>
    <label>Liga</label>
    <select id="ligaSelect">
      <option value="Champions League">Champions League</option>
      <option value="Premier League">Premier League</option>
      <option value="La Liga">La Liga</option>
    </select>
<label>Jornada</label>
<input type="number" id="jornadaInput" placeholder="NÃºmero de jornada (ej: 4)" min="1" />

    <!-- 1XBET -->
    <div class="form-container">
      <div class="form-box form-1xbet">
        <h3>1XBET</h3>
        <label>Gana Local</label>
        <input type="text" id="local1xbet" placeholder="Introduce el momio" />
        <label>Empate</label>
        <input type="text" id="empate1xbet" placeholder="Introduce el momio" />
        <label>Gana Visitante</label>
        <input type="text" id="visita1xbet" placeholder="Introduce el momio" />
        <label>1X</label>
        <input type="text" id="x11xbet" placeholder="Introduce el momio" />
        <label>2X</label>
        <input type="text" id="x21xbet" placeholder="Introduce el momio" />
        <label>Ambos Anotan (SÃ­)</label>
        <input type="text" id="ambosSi1xbet" placeholder="Introduce el momio" />
        <label>Ambos No Anotan</label>
        <input type="text" id="ambosNo1xbet" placeholder="Introduce el momio" />
        <label>MÃ¡s de goles</label>
        <select id="masGoles1xbet">
          <option value="">-- Selecciona --</option>
          <option value="0.5">MÃ¡s de 0.5</option>
          <option value="1.5">MÃ¡s de 1.5</option>
          <option value="2.5">MÃ¡s de 2.5</option>
          <option value="3.5">MÃ¡s de 3.5</option>
          <option value="4.5">MÃ¡s de 4.5</option>
        </select>
        <label>Cuota MÃ¡s</label>
        <input type="text" id="cuotaMas1xbet" placeholder="Introduce la cuota" />
        <label>Menos de goles</label>
        <select id="menosGoles1xbet">
          <option value="">-- Selecciona --</option>
          <option value="0.5">Menos de 0.5</option>
          <option value="1.5">Menos de 1.5</option>
          <option value="2.5">Menos de 2.5</option>
          <option value="3.5">Menos de 3.5</option>
          <option value="4.5">Menos de 4.5</option>
        </select>
        <label>Cuota Menos</label>
        <input type="text" id="cuotaMenos1xbet" placeholder="Introduce la cuota" />
      </div>
    </div>

    <button id="guardarRegistro">Guardar Registro</button>
    <p class="mensaje-error" id="mensajeError"></p>
  </div>
</div>
<button id="borrarTodoBtn" class="btn-rojo-flotante" title="AutodestrucciÃ³n">ğŸ’€ 
</button>

<!-- ğŸ”¹ Panel de indicadores a la izquierda -->
<div id="ap_indicadores">
  <div class="ap_item invertido">ğŸ’° Invertido: <span id="ap_invertido">$0</span></div>
  <div class="ap_item bank">ğŸ¦ Bank: <span id="ap_bank">$1000</span></div>
  <div class="ap_item ganancias">ğŸ“ˆ Ganancias: <span id="ap_ganancias">$0</span></div>
  <div class="ap_item enjuego">ğŸ¯ En juego: <span id="ap_enjuego">$0</span></div>
</div>

<!-- ğŸ”¹ Panel principal (permanece como lo tienes) -->
<div id="ap_panel_datos">
  <button id="ap_btn_nueva">+ Nueva Apuesta</button>

  <h3 style="margin-top: 10px;">Apuestas activas:</h3>
  <ul id="ap_lista"></ul>
</div>

</div>
  <!-- Ventana de registro -->
  <div id="ap_ventana">
    <h2>Registrar Apuesta</h2>

    <label>Liga:</label>
    <select id="ap_liga">
      <option>Champions League</option>
      <option>Premier League</option>
      <option>La Liga</option>
    </select>

    <label>Partido:</label>
    <input type="text" id="ap_partido" placeholder="Ej: Real Madrid vs City">

    <label>Apuesta:</label>
    <input type="text" id="ap_apuesta" placeholder="Ej: +2.5 goles">

    <label>Invertido ($):</label>
    <input type="number" id="ap_monto" placeholder="Monto invertido">

    <label>Ganancia posible ($):</label>
    <input type="number" id="ap_ganancia" placeholder="Ganancia posible">

    <div class="ap_botones">
      <button id="ap_btn_guardar">Guardar</button>
      <button id="ap_btn_cancelar">Cancelar</button>
    </div>
  </div>
  <!-- ğŸ”¹ MODAL HISTORIAL -->
<div id="modalHistorial" class="modal" style="display:none;">
  <div class="modal-content">
    <span class="close" id="cerrarHistorial">&times;</span>
    <h2>ğŸ“œ Historial de Registros</h2>
    
    <label>Selecciona Liga:</label>
    <select id="histLigaSelect">
      <option value="todas">ğŸŒ Todas</option>
      <option value="Champions League">ğŸ† Champions League</option>
      <option value="Premier League">ğŸ´ Premier League</option>
      <option value="La Liga">ğŸ‡ªğŸ‡¸ La Liga</option>
    </select>

    <label>Selecciona Jornada:</label>
    <input type="number" id="histJornadaInput" placeholder="NÃºmero de jornada (ej: 4)" min="1" />

    <button id="filtrarHistorialBtn">Filtrar</button>
    <div id="historialResultados" style="margin-top:15px;"></div>
  </div>
</div>

<!-- Contenedor del modal -->
<div id="detalleModal" class="modal-overlay" style="display:none;">
  <div class="modal">
    <button class="close-btn" id="cerrarModal">&times;</button>
    <h2 id="tituloPartido"></h2>
    <canvas id="graficaMomios"></canvas>
  </div>
</div>

<!-- ===== SOCKET + LIBRERIAS ===== -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script>

  <!-- ===== SCRIPTS PRINCIPALES ===== -->
  <script src="script.js?v=1.0.0" defer></script>
  <script src="apuestas.js?v=1.0.0" defer></script>
  <script src="historialRegistros.js?v=1.0.0" defer></script>

</body>
</html>